{% extends 'core/admin/base.html' %}
{% block title %}{{ action }} Expenditure - Admin{% endblock %}

{% block content %}
<div class="space-y-6">
  <div class="flex justify-between items-center">
    <h1 class="text-3xl font-bold text-gray-800">{{ action }} Expenditure</h1>
    <a href="{% url 'admin_finances' %}" class="px-4 py-2 bg-gray-600 text-white rounded-lg shadow hover:bg-gray-700 transition-colors duration-300">
      Back to Finances
    </a>
  </div>
  
  <div class="bg-white rounded-xl shadow-lg p-6">
    {% if available_funds %}
    <div class="mb-6 p-4 rounded-lg {% if available_funds < 0 %}bg-red-50 border border-red-200{% elif available_funds < 10000 %}bg-yellow-50 border border-yellow-200{% else %}bg-green-50 border border-green-200{% endif %}">
      <p class="text-sm font-medium text-gray-700">
        Available Funds: <span class="font-bold {% if available_funds < 0 %}text-red-600{% elif available_funds < 10000 %}text-yellow-600{% else %}text-green-600{% endif %}">₹{{ available_funds|floatformat:2 }}</span>
      </p>
      {% if available_funds < 0 %}
        <p class="text-xs text-red-600 mt-1">Warning: Available funds are negative. Please record donations before adding expenditures.</p>
      {% elif available_funds < 10000 %}
        <p class="text-xs text-yellow-600 mt-1">Low funds available. Consider recording donations before adding large expenditures.</p>
      {% endif %}
    </div>
    {% endif %}
    
    <form method="post" class="space-y-6">
      {% csrf_token %}
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <label for="description" class="block text-sm font-medium text-gray-700 mb-2">Description *</label>
          <input type="text" id="description" name="description" required 
                 value="{% if expenditure %}{{ expenditure.description }}{% endif %}"
                 class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
        </div>
        
        <div>
          <label for="amount" class="block text-sm font-medium text-gray-700 mb-2">Amount (₹) *</label>
          <input type="number" id="amount" name="amount" required step="0.01" min="0"
                 value="{% if expenditure %}{{ expenditure.amount }}{% endif %}"
                 class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          {% if available_funds %}
            <p class="text-xs text-gray-500 mt-1">Maximum: ₹{{ available_funds|floatformat:2 }}</p>
          {% endif %}
        </div>
        
        <div>
          <label for="date" class="block text-sm font-medium text-gray-700 mb-2">Date *</label>
          <input type="date" id="date" name="date" required
                 value="{% if expenditure %}{{ expenditure.date|date:'Y-m-d' }}{% else %}{{ 'now'|date:'Y-m-d' }}{% endif %}"
                 class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
        </div>
        
        <div>
          <label for="category" class="block text-sm font-medium text-gray-700 mb-2">Category *</label>
          <select id="category" name="category" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <option value="Supplies" {% if not expenditure or expenditure.category == 'Supplies' %}selected{% endif %}>Supplies</option>
            <option value="Utilities" {% if expenditure and expenditure.category == 'Utilities' %}selected{% endif %}>Utilities</option>
            <option value="Staff" {% if expenditure and expenditure.category == 'Staff' %}selected{% endif %}>Staff</option>
            <option value="Maintenance" {% if expenditure and expenditure.category == 'Maintenance' %}selected{% endif %}>Maintenance</option>
          </select>
        </div>
      </div>
      
      <div class="flex justify-end space-x-4">
        <a href="{% url 'admin_finances' %}" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors duration-300">
          Cancel
        </a>
        <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg shadow hover:bg-blue-700 transition-colors duration-300">
          {{ action }} Expenditure
        </button>
      </div>
    </form>
  </div>
</div>
{% endblock %}

